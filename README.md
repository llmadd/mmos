# MM OS

对LLM对话信息messages管理系统，优化短期记忆（减少上下文token消耗、话题分类等）、为模型提供长期记忆（历史对话抽象为事件、对话构建历史图谱、打造模型性格等）。


## 核心特性

✨ **分层记忆架构**
- 短期记忆：保留最近2-3轮原始对话（兼容OpenAI messages格式）
- 对话自动剥离： 多轮对话中判断对话相关性，完全无关对话剥离
- 事件概念： 将相关多轮对话抽象为对话事件，并构建索引
- 知识图谱：对话中进行搭建记忆知识图谱、角色知识图谱
- 长期记忆：意图识别结合事件检索、记忆图谱等，为模型提供长期记忆
- 角色塑造： 对话过程中塑造模型形象更契合用户行为


### **MM OS 技术要点梳理**  

#### **1. 短期记忆（Short-Term Memory）**  
- **最近对话窗口**：维护一个固定长度的 `deque` 或 `list`，存储最近几轮对话（可配置）。  
- **对话压缩**：  
  - **摘要式压缩**：用 LLM（如 `gpt-3.5-turbo`）生成对话摘要。  
  - **关键信息提取**：用 NLP 技术（如 `spaCy` 或 `KeyBERT`）提取关键实体/意图。
  - **用户新信息对别**： 结合内容切割level4，关联不大的为新事件  
- **临时向量表**：  
  - 使用轻量级向量检索（如 `FAISS` 或 `Annoy`），存储当前会话的临时记忆，支持快速召回。  

#### **2. 长期记忆（Long-Term Memory）**  
##### **2.1 混合检索系统**  
- **向量检索**（语义相似性）：  
  - 使用 `Sentence-BERT` 或 `OpenAI Embeddings` 编码记忆片段。  
  - 存储到向量数据库（如 `FAISS` 或 `Weaviate`）。  
- **稀疏检索**（关键词匹配）：  
  - 用 `BM25` 或 `TF-IDF` 实现精确匹配（如日期、人名）。  

##### **2.2 记忆图谱（Knowledge Graph）**  
- **存储结构**：  
  - 节点：`用户`、`记忆片段`、`实体`（如"咖啡"、"巴黎"）。  
  - 边：关系（如"喜欢"、"去过"）。  
- **查询方式**：  
  - 图遍历（如"用户 → 喜欢 → 咖啡 → 品牌"）。  

##### **2.3 角色塑造（Persona Modeling）**  
- **静态属性**（长期稳定）：  
  - 身份（性别、职业）、性格（OCEAN 五人格模型）。  
- **动态状态**（实时变化）：  
  - 情绪（`Valence-Arousal` 模型）、生理状态（疲劳度、活跃度）。  
- **行为偏好**：  
  - 交互风格（简洁/详细）、常用词汇/表情。  
- **个性化记忆锚点**：  
  - 用户特定记忆（如"用户讨厌洋葱"）。  
  - 关系演进（如"从陌生人 → 朋友"）。  

#### **3. 记忆管理策略**  
- **记忆衰减**：  
  - 基于时间（LRU）或重要性（权重衰减）。  
- **记忆融合**：  
  - 新旧记忆冲突时，用 LLM 或规则进行合并/去重。  
- **隐私保护**：  
  - 敏感信息脱敏（如 `NER` + 替换）。  


## 🚀开发计划

✅ **MVP功能**
- [ ] 短期记忆管理
    - [ ] 相关性判断
    - [ ] 自动消息切割
- [ ] 历史对话转事件
    - [ ] 内容压缩
    - [ ] 事件索引搭建
    - [ ] 事件图谱搭建
- [ ] 长期记忆
    - [ ] 用户意图识别
    - [ ] 问题相关记忆检索
    - [ ] 召回算法及精度提升
- [ ] 模型角色性格板块（0.2版本）
- [ ] 可视化记忆面板（0.2版本）
- [ ] 多模态记忆支持（0.3版本）
- [ ] 更多...

## 贡献指南

欢迎通过Issue或PR参与建设！推荐贡献方向：
1. 更智能的事件切割算法
2. 智能知识图谱构建算法
3. 用户意图识别以及记忆召回精度相关算法
4. 记忆管理以及性格塑造想法
5. 更多有关大模型记忆管理想法...

## 许可证

本项目采用 [MIT License](LICENSE) 开源